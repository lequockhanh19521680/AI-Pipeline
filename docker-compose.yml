services:
  vault:
    image: vault:1.15.2
    container_name: ai-pipeline-vault
    ports:
      - "8200:8200"
    environment:
      VAULT_DEV_ROOT_TOKEN_ID: "root"
      VAULT_DEV_LISTEN_ADDRESS: "0.0.0.0:8200"
    command: ["vault", "server", "-dev", "-dev-root-token-id=root", "-dev-listen-address=0.0.0.0:8200"]
    networks:
      - ai-pipeline

  config-service:
    build:
      context: ./services/config-service
      dockerfile: Dockerfile
    container_name: ai-pipeline-config-service
    ports:
      - "8080:8080"
      - "9090:9090"
    environment:
      VAULT_ADDR: "http://vault:8200"
      VAULT_TOKEN: "root"
      SERVER_PORT: "8080"
      GRPC_PORT: "9090"
    depends_on:
      - vault
    networks:
      - ai-pipeline

networks:
  ai-pipeline:
    driver: bridge